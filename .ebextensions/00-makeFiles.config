files:
    "/sbin/appstart" :
        mode: "000755"
        owner: webapp
        group: webapp
        content: |
            #!/usr/bin/env bash
            JAR_PATH=/var/app/current/application.jar

            # Ensure log directory exists and has correct permissions
            sudo mkdir -p /var/log/web
            sudo chown webapp:webapp /var/log/web
            sudo chmod 755 /var/log/web

            # run app
            java -Dfile.encoding=UTF-8 -jar $JAR_PATH > /var/log/web/web.stdout.log 2>&1 &
            echo $! > /var/run/web.pid
